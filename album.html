<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>√Ålbum Ricordi Eterni</title>
<style>
body { font-family:"Times New Roman", Times, serif; background:#0B3C91; text-align:center; margin:0; padding:20px; }
#album { max-width:480px; margin:20px auto; display:flex; flex-wrap:wrap; gap:10px; justify-content:center; }
#album img { width: 100%; max-width:200px; border-radius:10px; }
p { color:#FFF; font-size:18px; }
</style>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

<h1 style="color:#FFF;">üì∏ √Ålbum Ricordi Eterni üì∏</h1>
<div id="album"></div>
<p id="mensaje">Cargando √°lbum...</p>

<script>
const SUPABASE_URL = "https://fxknmcntonqlvllbpgun.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ4a25tY250b25xbHZsbGJwZ3VuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA2NTkwMjksImV4cCI6MjA4NjIzNTAyOX0.J0M_pHArOFRF8_QvHebNWS9E0ZLPlax6tr9fknQ9XOI";
const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

const albumDiv = document.getElementById("album");
const mensaje = document.getElementById("mensaje");

async function mostrarAlbum(){
  mensaje.innerText = "Cargando √°lbum...";
  albumDiv.innerHTML = "";

  try {
    const { data, error } = await supabase.storage.from('album').list('Album de recuerdos', {
      limit: 100,
      sortBy: { column: 'name', order: 'desc' }
    });

    if(error) throw error;

    if(data.length === 0){
      mensaje.innerText = "No hay fotos a√∫n. ¬°S√© el primero en subir un recuerdo!";
      return;
    }

    data.forEach(file => {
      const img = document.createElement("img");
      img.src = `${SUPABASE_URL}/storage/v1/object/public/album/Album de recuerdos/${file.name}`;
      albumDiv.appendChild(img);
    });

    mensaje.innerText = "";

  } catch(err){
    console.error(err);
    mensaje.innerText = "‚ùå No se pudieron cargar las fotos.";
  }
}

// Mostrar √°lbum al cargar
mostrarAlbum();

// Actualizaci√≥n autom√°tica cada 15 segundos
setInterval(mostrarAlbum, 15000);
</script>

</body>
</html>
